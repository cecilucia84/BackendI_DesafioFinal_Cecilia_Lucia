<h1>Lista de productos</h1>
<ul>
  {{#each products.payload}} 
  <li>
    <h2>{{this.title}}</h2> 
    <p>{{this.description}}</p>
    <p>Precio: {{this.price}}</p>
    <p>Categoría: {{this.category}}</p>
    <button onclick="addToCart('{{this._id}}')">Agregar al carrito</button>
    <a href="/products/{{this._id}}">Ver detalles</a>
  </li>
  {{/each}}
</ul>

<div>
  {{#if products.hasPrevPage}} 
  <a href="{{products.prevLink}}">Anterior</a>
  {{/if}}
  <span>Página {{products.page}} de {{products.totalPages}}</span>
  {{#if products.hasNextPage}}
  <a href="{{products.nextLink}}">Siguiente</a>
  {{/if}}
</div>

<script>
  function addToCart(productId) {
    const cartId = '66fdb280ce811c8293e42e41';
  
    fetch(`/api/carts/${cartId}/products/${productId}`, { 
      method: 'PUT', 
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ quantity: 1 }) 
    })
    .then(response => response.json())
    .then(data => {
      if (data.status === 'success') {
        alert('Producto agregado al carrito');
      } else {
        alert('Error al agregar el producto al carrito');
      }
    })
    .catch(error => {
      console.error('Error al agregar al carrito:', error);
    });
  }
</script>
